? changes
? Renderers/MyDocBook
Index: Packages/book.py
===================================================================
RCS file: /cvsroot/plastex/plastex/plasTeX/Packages/book.py,v
retrieving revision 1.14
diff -r1.14 book.py
34a35,36
>     context.newcounter('exercise', resetby='chapter',
>                        format='${thechapter}.${exercise}')
Index: Renderers/DocBook/Floats.zpts
===================================================================
RCS file: /cvsroot/plastex/plastex/plasTeX/Renderers/DocBook/Floats.zpts,v
retrieving revision 1.2
diff -r1.2 Floats.zpts
7c7
<           tal:attributes="label self/title/id" 
---
>           tal:attributes="id self/title/id" 
Index: Renderers/DocBook/Math.zpts
===================================================================
RCS file: /cvsroot/plastex/plastex/plasTeX/Renderers/DocBook/Math.zpts,v
retrieving revision 1.7
diff -r1.7 Math.zpts
31c31
< <informaltable remap="equation" tal:attributes="xml:id self/id">
---
> <informaltable remap="equation" tal:attributes="id self/id">
62,63c62,63
< <informaltable remap="eqnarray" tal:attributes="xml:id self/id">
< <tr tal:repeat="row self" tal:attributes="xml:id row/id">
---
> <informaltable remap="eqnarray" tal:attributes="id self/id">
> <tr tal:repeat="row self" tal:attributes="id row/id">
Index: Renderers/DocBook/__init__.py
===================================================================
RCS file: /cvsroot/plastex/plastex/plasTeX/Renderers/DocBook/__init__.py,v
retrieving revision 1.4
diff -r1.4 __init__.py
4a5,11
> head = """<?xml version="1.0"?>
> <!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
> "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
> """
> 
> foot = ""
> 
16a24,31
> 
>         s = '%s%s%s' % (head, s, foot)
> 
>         # Force XHTML syntax on empty tags
>         s = re.compile(r'(<(?:hr|br|img|link|meta|col)\b.*?)\s*/?\s*(>)', 
>                        re.I|re.S).sub(r'\1 /\2', s)
> 
>         s = re.compile(r'xml:id',re.I).sub(r'id',s)
18a34,44
>         s = re.compile(r'<para>\s*([^<]*<imageobject)',re.I).sub(r'\1',s)
>         s = re.compile(r'(</imageobject>)\s*</para>',re.I).sub(r'\1',s)
>         #
>         s = re.compile(r'<para>\s*(<figure)',re.I).sub(r'\1',s)
>         s = re.compile(r'(</figure>)\s*</para>',re.I).sub(r'\1',s)
>         #
>         s = re.compile(r'<para>([^<]*<title)',re.I).sub(r'\1',s)
>         s = re.compile(r'(</mediaobject>)\s*</para>',re.I).sub(r'\1',s)
>         #
>         s = re.compile(r'<para>\s*(<anchor[^>]*>)\s*</para>',re.I).sub(r'',s)
>         #
21a48,50
>         s = re.compile(r'<articleinfo>',re.I).sub(r'<bookinfo>',s)
>         s = re.compile(r'</articleinfo>',re.I).sub(r'</bookinfo>',s)
>         #
24a54,56
>         #s = re.compile(r'<para>\s*(<indexterm)',re.I).sub(r'\1',s)
>         #s = re.compile(r'(</indexterm>)\s*</para>',re.I).sub(r'\1',s)
>         #
Index: Renderers/DocBook/graphicx.zpts
===================================================================
RCS file: /cvsroot/plastex/plastex/plasTeX/Renderers/DocBook/graphicx.zpts,v
retrieving revision 1.2
diff -r1.2 graphicx.zpts
2,7c2,7
< <imageobject remap="includegraphics">
<   <imagedata tal:attributes="fileref self/image/url;contentwidth self/image/width/px;contentdepth self/image/height/px" />
<   <textobject>
<     <phrase tal:content="text self/source"></phrase>
<   </textobject>
< </imageobject>
---
> <title></title>
> <mediaobject>
>   <imageobject remap="includegraphics">
>     <imagedata tal:attributes="fileref self/image/url;contentwidth self/image/width/px;contentdepth self/image/height/px" />
>   </imageobject>
> </mediaobject>
